<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
  <html xmlns="http://www.w3.org/1999/xhtml">
		<head>
			<!-- template designed by Marco Von Ballmoos  -->
			<title>Docs For Class FOFEncryptTotp</title>
			<link rel="stylesheet" href="../../media/stylesheet.css" />
						<script src="../../media/lib/classTree.js"></script>
												<script language="javascript" type="text/javascript">
				var imgPlus = new Image();
				var imgMinus = new Image();
				imgPlus.src = "../../media/images/plus.png";
				imgMinus.src = "../../media/images/minus.png";
				
				function showNode(Node){
							switch(navigator.family){
								case 'nn4':
									// Nav 4.x code fork...
							var oTable = document.layers["span" + Node];
							var oImg = document.layers["img" + Node];
									break;
								case 'ie4':
									// IE 4/5 code fork...
							var oTable = document.all["span" + Node];
							var oImg = document.all["img" + Node];
									break;
								case 'gecko':
									// Standards Compliant code fork...
							var oTable = document.getElementById("span" + Node);
							var oImg = document.getElementById("img" + Node);
									break;
							}
					oImg.src = imgMinus.src;
					oTable.style.display = "block";
				}
				
				function hideNode(Node){
							switch(navigator.family){
								case 'nn4':
									// Nav 4.x code fork...
							var oTable = document.layers["span" + Node];
							var oImg = document.layers["img" + Node];
									break;
								case 'ie4':
									// IE 4/5 code fork...
							var oTable = document.all["span" + Node];
							var oImg = document.all["img" + Node];
									break;
								case 'gecko':
									// Standards Compliant code fork...
							var oTable = document.getElementById("span" + Node);
							var oImg = document.getElementById("img" + Node);
									break;
							}
					oImg.src = imgPlus.src;
					oTable.style.display = "none";
				}
				
				function nodeIsVisible(Node){
							switch(navigator.family){
								case 'nn4':
									// Nav 4.x code fork...
							var oTable = document.layers["span" + Node];
									break;
								case 'ie4':
									// IE 4/5 code fork...
							var oTable = document.all["span" + Node];
									break;
								case 'gecko':
									// Standards Compliant code fork...
							var oTable = document.getElementById("span" + Node);
									break;
							}
					return (oTable && oTable.style.display == "block");
				}
				
				function toggleNodeVisibility(Node){
					if (nodeIsVisible(Node)){
						hideNode(Node);
					}else{
						showNode(Node);
					}
				}
			</script>
					</head>
		<body>
			<div class="page-body">			
<h2 class="class-name"><img src="../../media/images/Class_logo.png"
														alt=" Class"
														title=" Class"
														style="vertical-align: middle"> FOFEncryptTotp</h2>

<a name="sec-description"></a>
<div class="info-box">
	<div class="info-box-title">Description</div>
	<div class="nav-bar">
					<span class="disabled">Description</span> |
															<a href="#sec-method-summary">Methods</a> (<a href="#sec-methods">details</a>)
						
					</div>
	<div class="info-box-body">
        		<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">This class provides an RFC6238-compliant Time-based One Time Passwords,  compatible with Google Authenticator (with PassCodeLength = 6 and TimePeriod = 30).</p>
	<ul class="tags">
				<li><span class="field">since:</span> 1.0</li>
			</ul>
		<p class="notes">
			Located in <a class="field" href="_libraries---fof---encrypt---totp.php.html">/libraries/fof/encrypt/totp.php</a> (line <span class="field"><a href="../../filesource/fsource_FrameworkOnFramework_encrypt_librariesfofencrypttotp.php.html#a17">17</a></span>)
		</p>
		
				
		<pre></pre>
	
			</div>
</div>




	<a name="sec-method-summary"></a>
	<div class="info-box">
		<div class="info-box-title">Method Summary</span></div>
		<div class="nav-bar">
			<a href="#sec-description">Description</a> |
												<span class="disabled">Methods</span> (<a href="#sec-methods">details</a>)
		</div>
		<div class="info-box-body">			
			<div class="method-summary">
																																																																							
				<div class="method-definition">
					<img src="../../media/images/Constructor.png" alt=" "/>
											<span class="method-result">FOFEncryptTotp</span>
										<a href="#__construct" title="details" class="method-name">__construct</a>
											([<span class="var-type">int</span>&nbsp;<span class="var-name">$timeStep</span> = <span class="var-default">30</span>], [<span class="var-type">int</span>&nbsp;<span class="var-name">$passCodeLength</span> = <span class="var-default">6</span>], [<span class="var-type">int</span>&nbsp;<span class="var-name">$secretLength</span> = <span class="var-default">10</span>])
									</div>
															
				<div class="method-definition">
					<img src="../../media/images/Method.png" alt=" "/>
											<span class="method-result">boolean</span>
										<a href="#checkCode" title="details" class="method-name">checkCode</a>
											(<span class="var-type">string</span>&nbsp;<span class="var-name">$secret</span>, <span class="var-type">string</span>&nbsp;<span class="var-name">$code</span>)
									</div>
															
				<div class="method-definition">
					<img src="../../media/images/Method.png" alt=" "/>
											<span class="method-result">string</span>
										<a href="#generateSecret" title="details" class="method-name">generateSecret</a>
										()
									</div>
															
				<div class="method-definition">
					<img src="../../media/images/Method.png" alt=" "/>
											<span class="method-result">string</span>
										<a href="#getCode" title="details" class="method-name">getCode</a>
											(<span class="var-type">string</span>&nbsp;<span class="var-name">$secret</span>, [<span class="var-type">int</span>&nbsp;<span class="var-name">$time</span> = <span class="var-default">null</span>])
									</div>
															
				<div class="method-definition">
					<img src="../../media/images/Method.png" alt=" "/>
											<span class="method-result">int</span>
										<a href="#getPeriod" title="details" class="method-name">getPeriod</a>
											([<span class="var-type">int|null</span>&nbsp;<span class="var-name">$time</span> = <span class="var-default">null</span>])
									</div>
															
				<div class="method-definition">
					<img src="../../media/images/Method.png" alt=" "/>
											<span class="method-result">string</span>
										<a href="#getUrl" title="details" class="method-name">getUrl</a>
											(<span class="var-type">string</span>&nbsp;<span class="var-name">$user</span>, <span class="var-type">string</span>&nbsp;<span class="var-name">$hostname</span>, <span class="var-type">string</span>&nbsp;<span class="var-name">$secret</span>)
									</div>
															
				<div class="method-definition">
					<img src="../../media/images/Method.png" alt=" "/>
											<span class="method-result">string</span>
										<a href="#hashToInt" title="details" class="method-name">hashToInt</a>
											(<span class="var-type">string</span>&nbsp;<span class="var-name">$bytes</span>, <span class="var-type">string</span>&nbsp;<span class="var-name">$start</span>)
									</div>
											</div>
		</div>
	</div>		

	
	<a name="sec-methods"></a>
	<div class="info-box">
		<div class="info-box-title">Methods</div>
		<div class="nav-bar">
			<a href="#sec-description">Description</a> |
																<a href="#sec-method-summary">Methods</a> (<span class="disabled">details</span>)
						
		</div>
		<div class="info-box-body">
			<A NAME='method_detail'></A>
<a name="method__construct" id="__construct"><!-- --></a>
<div class="oddrow">
	
	<div class="method-header">
		<img src="../../media/images/Constructor.png" />
		<span class="method-title">Constructor __construct</span> (line <span class="line-number"><a href="../../__filesource/ource_FrameworkOnFramework_encrypt_librariesfofencrypttotp.php.html#a37">37</a></span>)
	</div> 
	
	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Initialises an RFC6238-compatible TOTP generator. Please note that this  class does not implement the constraint in the last paragraph of §5.2  of RFC6238. It's up to you to ensure that the same user/device does not  retry validation within the same Time Step.</p>
	<ul class="tags">
				<li><span class="field">access:</span> public</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">FOFEncryptTotp</span>
		<span class="method-name">
			__construct
		</span>
					([<span class="var-type">int</span>&nbsp;<span class="var-name">$timeStep</span> = <span class="var-default">30</span>], [<span class="var-type">int</span>&nbsp;<span class="var-name">$passCodeLength</span> = <span class="var-default">6</span>], [<span class="var-type">int</span>&nbsp;<span class="var-name">$secretLength</span> = <span class="var-default">10</span>])
			</div>
	
			<ul class="parameters">
					<li>
				<span class="var-type">int</span>
				<span class="var-name">$timeStep</span><span class="var-description">: The Time Step (in seconds). Use 30 to be compatible with Google Authenticator.</span>			</li>
					<li>
				<span class="var-type">int</span>
				<span class="var-name">$passCodeLength</span><span class="var-description">: The generated passcode length. Default: 6 digits.</span>			</li>
					<li>
				<span class="var-type">int</span>
				<span class="var-name">$secretLength</span><span class="var-description">: The length of the secret key. Default: 10 bytes (80 bits).</span>			</li>
				</ul>
		
			
	</div>
<a name="methodcheckCode" id="checkCode"><!-- --></a>
<div class="evenrow">
	
	<div class="method-header">
		<img src="../../media/images/Method.png" />
		<span class="method-title">checkCode</span> (line <span class="line-number"><a href="../../__fifilesource/rce_FrameworkOnFramework_encrypt_librariesfofencrypttotp.php.html#a75">75</a></span>)
	</div> 
	
	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Check is the given passcode $code is a valid TOTP generated using secret  key $secret</p>
	<ul class="tags">
				<li><span class="field">return:</span> True if the code is valid</li>
				<li><span class="field">access:</span> public</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">boolean</span>
		<span class="method-name">
			checkCode
		</span>
					(<span class="var-type">string</span>&nbsp;<span class="var-name">$secret</span>, <span class="var-type">string</span>&nbsp;<span class="var-name">$code</span>)
			</div>
	
			<ul class="parameters">
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$secret</span><span class="var-description">: The Base32-encoded secret key</span>			</li>
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$code</span><span class="var-description">: The passcode to check</span>			</li>
				</ul>
		
			
	</div>
<a name="methodgenerateSecret" id="generateSecret"><!-- --></a>
<div class="oddrow">
	
	<div class="method-header">
		<img src="../../media/images/Method.png" />
		<span class="method-title">generateSecret</span> (line <span class="line-number"><a href="../../__filefilesource/e_FrameworkOnFramework_encrypt_librariesfofencrypttotp.php.html#a157">157</a></span>)
	</div> 
	
	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Generates a (semi-)random Secret Key for TOTP generation</p>
	<ul class="tags">
				<li><span class="field">access:</span> public</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">string</span>
		<span class="method-name">
			generateSecret
		</span>
				()
			</div>
	
		
			
	</div>
<a name="methodgetCode" id="getCode"><!-- --></a>
<div class="evenrow">
	
	<div class="method-header">
		<img src="../../media/images/Method.png" />
		<span class="method-title">getCode</span> (line <span class="line-number"><a href="../../__filesofilesource/FrameworkOnFramework_encrypt_librariesfofencrypttotp.php.html#a99">99</a></span>)
	</div> 
	
	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Gets the TOTP passcode for a given secret key $secret and a given UNIX  timestamp $time</p>
	<ul class="tags">
				<li><span class="field">access:</span> public</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">string</span>
		<span class="method-name">
			getCode
		</span>
					(<span class="var-type">string</span>&nbsp;<span class="var-name">$secret</span>, [<span class="var-type">int</span>&nbsp;<span class="var-name">$time</span> = <span class="var-default">null</span>])
			</div>
	
			<ul class="parameters">
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$secret</span><span class="var-description">: The Base32-encoded secret key</span>			</li>
					<li>
				<span class="var-type">int</span>
				<span class="var-name">$time</span><span class="var-description">: UNIX timestamp</span>			</li>
				</ul>
		
			
	</div>
<a name="methodgetPeriod" id="getPeriod"><!-- --></a>
<div class="oddrow">
	
	<div class="method-header">
		<img src="../../media/images/Method.png" />
		<span class="method-title">getPeriod</span> (line <span class="line-number"><a href="../../__filesourfilesource/ameworkOnFramework_encrypt_librariesfofencrypttotp.php.html#a54">54</a></span>)
	</div> 
	
	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Get the time period based on the $time timestamp and the Time Step  defined. If $time is skipped or set to null the current timestamp will  be used.</p>
	<ul class="tags">
				<li><span class="field">return:</span> The time period since the UNIX Epoch</li>
				<li><span class="field">access:</span> public</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">int</span>
		<span class="method-name">
			getPeriod
		</span>
					([<span class="var-type">int|null</span>&nbsp;<span class="var-name">$time</span> = <span class="var-default">null</span>])
			</div>
	
			<ul class="parameters">
					<li>
				<span class="var-type">int|null</span>
				<span class="var-name">$time</span><span class="var-description">: Timestamp</span>			</li>
				</ul>
		
			
	</div>
<a name="methodgetUrl" id="getUrl"><!-- --></a>
<div class="evenrow">
	
	<div class="method-header">
		<img src="../../media/images/Method.png" />
		<span class="method-title">getUrl</span> (line <span class="line-number"><a href="../../__filesourcefilesource/eworkOnFramework_encrypt_librariesfofencrypttotp.php.html#a143">143</a></span>)
	</div> 
	
	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Returns a QR code URL for easy setup of TOTP apps like Google Authenticator</p>
	<ul class="tags">
				<li><span class="field">access:</span> public</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">string</span>
		<span class="method-name">
			getUrl
		</span>
					(<span class="var-type">string</span>&nbsp;<span class="var-name">$user</span>, <span class="var-type">string</span>&nbsp;<span class="var-name">$hostname</span>, <span class="var-type">string</span>&nbsp;<span class="var-name">$secret</span>)
			</div>
	
			<ul class="parameters">
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$user</span><span class="var-description">: User</span>			</li>
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$hostname</span><span class="var-description">: Hostname</span>			</li>
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$secret</span><span class="var-description">: Secret string</span>			</li>
				</ul>
		
			
	</div>
<a name="methodhashToInt" id="hashToInt"><!-- --></a>
<div class="oddrow">
	
	<div class="method-header">
		<img src="../../media/images/Method.png" />
		<span class="method-title">hashToInt</span> (line <span class="line-number"><a href="../../__filesource/fsource_FrameworkOnFramework_encrypt_librariesfofencrypttotp.php.html#a126">126</a></span>)
	</div> 
	
	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Extracts a part of a hash as an integer</p>
	<ul class="tags">
				<li><span class="field">access:</span> protected</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">string</span>
		<span class="method-name">
			hashToInt
		</span>
					(<span class="var-type">string</span>&nbsp;<span class="var-name">$bytes</span>, <span class="var-type">string</span>&nbsp;<span class="var-name">$start</span>)
			</div>
	
			<ul class="parameters">
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$bytes</span><span class="var-description">: The hash</span>			</li>
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$start</span><span class="var-description">: The char to start from (0 = first char)</span>			</li>
				</ul>
		
			
	</div>
						
		</div>
	</div>

	
	<p class="notes" id="credit">
		Documentation generated on Wed, 13 Nov 2013 15:14:34 +0100 by <a href="http://www.phpdoc.org" target="_blank">phpDocumentor 1.4.3</a>
	</p>
	</div></body>
</html>